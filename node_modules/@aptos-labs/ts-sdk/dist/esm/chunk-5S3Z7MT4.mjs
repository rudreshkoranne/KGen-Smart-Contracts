import{a as y,f as P,g as C,i as b}from"./chunk-22ZSW5EN.mjs";import{a as I}from"./chunk-Y267I7DC.mjs";import{a as f}from"./chunk-5SGSPCOY.mjs";import{a as w}from"./chunk-3H5DGQKX.mjs";import{a as A}from"./chunk-CDQGPCHU.mjs";import{d as h}from"./chunk-WSZCPSV4.mjs";import{c as T,m as c}from"./chunk-OTY3NO7Q.mjs";import{a as l}from"./chunk-A2AEFKXS.mjs";import{b as d}from"./chunk-2652SPOM.mjs";import{b as p}from"./chunk-KM6UXNC7.mjs";import{a as s}from"./chunk-IECDO22V.mjs";import{b as m}from"./chunk-6FLHGOKP.mjs";async function S(t){let e=await K(t);return U(t,e)}async function K(t){let{aptosConfig:e,data:n}=t,a,o;return"bytecode"in n?o=await y(n):"multisigAddress"in n?(a={aptosConfig:e,multisigAddress:n.multisigAddress,function:n.function,functionArguments:n.functionArguments,typeArguments:n.typeArguments,abi:n.abi},o=await y(a)):(a={aptosConfig:e,function:n.function,functionArguments:n.functionArguments,typeArguments:n.typeArguments,abi:n.abi},o=await y(a)),o}async function U(t,e){let{aptosConfig:n,sender:a,options:o}=t,i;if(_(t)&&(i=p.ZERO.toString()),B(t)){let{secondarySignerAddresses:r}=t;return P({aptosConfig:n,sender:a,payload:e,options:o,secondarySignerAddresses:r,feePayerAddress:i})}return P({aptosConfig:n,sender:a,payload:e,options:o,feePayerAddress:i})}function _(t){return t.withFeePayer===!0}function B(t){return"secondarySignerAddresses"in t}function Y(t){let{transaction:e}=t;return h(e)}function R(t){let{signer:e,transaction:n}=t;return e.signTransactionWithAuthenticator(n)}function x(t){let{signer:e,transaction:n}=t;if(!n.feePayerAddress)throw new Error(`Transaction ${n} is not a Fee Payer transaction`);return n.feePayerAddress=e.accountAddress,R({signer:e,transaction:n})}async function nn(t){let{aptosConfig:e,transaction:n,signerPublicKey:a,secondarySignersPublicKeys:o,feePayerPublicKey:i,options:r}=t,u=C({transaction:n,signerPublicKey:a,secondarySignersPublicKeys:o,feePayerPublicKey:i,options:r}),{data:g}=await d({aptosConfig:e,body:u,path:"transactions/simulate",params:{estimate_gas_unit_price:t.options?.estimateGasUnitPrice??!1,estimate_max_gas_amount:t.options?.estimateMaxGasAmount??!1,estimate_prioritized_gas_unit_price:t.options?.estimatePrioritizedGasUnitPrice??!1},originMethod:"simulateTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return g}async function F(t){let{aptosConfig:e}=t,n=b({...t}),{data:a}=await d({aptosConfig:e,body:n,path:"transactions",originMethod:"submitTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return a}async function M(t){let{aptosConfig:e,signer:n,feePayer:a,transaction:o}=t;(n instanceof A||n instanceof f)&&await n.waitForProofFetch(),(a instanceof A||a instanceof f)&&await a.waitForProofFetch();let i=t.feePayerAuthenticator||a&&x({signer:a,transaction:o}),r=R({signer:n,transaction:o});return F({aptosConfig:e,transaction:o,senderAuthenticator:r,feePayerAuthenticator:i})}async function tn(t){let{aptosConfig:e,senderAuthenticator:n,feePayer:a,transaction:o}=t;(a instanceof A||a instanceof f)&&await a.waitForProofFetch();let i=x({signer:a,transaction:o});return F({aptosConfig:e,transaction:o,senderAuthenticator:n,feePayerAuthenticator:i})}var v={typeParameters:[],parameters:[c.u8(),new c(c.u8())]};async function en(t){let{aptosConfig:e,account:n,metadataBytes:a,moduleBytecode:o,options:i}=t,r=o.map(u=>s.U8(u));return S({aptosConfig:e,sender:p.from(n),data:{function:"0x1::code::publish_package_txn",functionArguments:[s.U8(a),new s(r)],abi:v},options:i})}var N={typeParameters:[],parameters:[new T,c.u8(),new T,c.u8(),c.u8(),c.u8()]};async function an(t){let{aptosConfig:e,fromAccount:n,toNewPrivateKey:a}=t,o=await I({aptosConfig:e,accountAddress:n.accountAddress}),i=w.fromPrivateKey({privateKey:a,legacy:!0}),u=new l({sequenceNumber:BigInt(o.sequence_number),originator:n.accountAddress,currentAuthKey:p.from(o.authentication_key),newPublicKey:i.publicKey}).bcsToBytes(),g=n.sign(u),D=i.sign(u),G=await S({aptosConfig:e,sender:n.accountAddress,data:{function:"0x1::account::rotate_authentication_key",functionArguments:[new m(n.signingScheme),s.U8(n.publicKey.toUint8Array()),new m(i.signingScheme),s.U8(i.publicKey.toUint8Array()),s.U8(g.toUint8Array()),s.U8(D.toUint8Array())],abi:N}});return M({aptosConfig:e,signer:n,transaction:G})}export{S as a,K as b,U as c,Y as d,R as e,x as f,nn as g,F as h,M as i,tn as j,en as k,an as l};
//# sourceMappingURL=chunk-5S3Z7MT4.mjs.map